specVersion: 0.0.2
description: Smart Invoice
schema:
  file: schema.graphql
dataSources:
  - kind: ethereum/contract
    name: SmartInvoiceFactoryVersion00
    network: metertest
    source:
      address: "0x588bAF3e28fA8CDE7B2FA75405478bF4eFA15A73"
      abi: SmartInvoiceFactory
      startBlock: 15018939
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Invoice
      abis:
        - name: ERC20
          file: SmartInvoiceFactoryVersion00/src/abis/ERC20.json
        - name: SmartInvoice
          file: SmartInvoiceFactoryVersion00/src/abis/SmartInvoice.json
        - name: SmartInvoiceFactory
          file: SmartInvoiceFactoryVersion00/src/abis/SmartInvoiceFactory.json
      eventHandlers:
        - event: LogNewInvoice(indexed uint256,address,uint256[])
          handler: handleLogNewInvoice
      file: SmartInvoiceFactoryVersion00/SmartInvoiceFactoryVersion00.wasm
templates:
  - kind: ethereum/contract
    name: SmartInvoice
    network: metertest
    source:
      abi: SmartInvoice
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Invoice
        - Release
        - Deposit
        - Resolution
        - Token
      abis:
        - name: ERC20
          file: SmartInvoice/src/abis/ERC20.json
        - name: SmartInvoice
          file: SmartInvoice/src/abis/SmartInvoice.json
        - name: SmartInvoiceFactory
          file: SmartInvoice/src/abis/SmartInvoiceFactory.json
      eventHandlers:
        - event: Release(uint256,uint256)
          handler: handleRelease
        - event: Withdraw(uint256)
          handler: handleWithdraw
        - event: Lock(indexed address,bytes32)
          handler: handleLock
        - event: Rule(indexed address,uint256,uint256,uint256)
          handler: handleRule
        - event: Resolve(indexed address,uint256,uint256,uint256,bytes32)
          handler: handleResolve
        - event: Deposit(indexed address,uint256)
          handler: handleDeposit
      file: templates/SmartInvoice/SmartInvoice.wasm
  - kind: ethereum/contract
    name: ERC20
    network: metertest
    source:
      abi: ERC20
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.5
      language: wasm/assemblyscript
      entities:
        - Token
        - Deposit
      abis:
        - name: ERC20
          file: ERC20/src/abis/ERC20.json
        - name: SmartInvoice
          file: ERC20/src/abis/SmartInvoice.json
        - name: SmartInvoiceFactory
          file: ERC20/src/abis/SmartInvoiceFactory.json
      eventHandlers:
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: templates/ERC20/ERC20.wasm
